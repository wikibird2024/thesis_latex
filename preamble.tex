
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%           VIETNAMESE LATEX THESIS PREAMBLE - XELATEX OPTIMIZED
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% --- XeLaTeX required ---
\usepackage{fontspec}

% --- Polyglossia for Vietnamese and English ---
\usepackage{polyglossia}
\setmainlanguage{vietnamese}
\setotherlanguage{english}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        FONT CONFIGURATION
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setmainfont{Liberation Serif}[
    BoldFont = Liberation Serif Bold,
    ItalicFont = Liberation Serif Italic,
    BoldItalicFont = Liberation Serif Bold Italic
]
\setsansfont{Liberation Sans}[
    BoldFont = Liberation Sans Bold,
    ItalicFont = Liberation Sans Italic,
    BoldItalicFont = Liberation Sans Bold Italic
]
\setmonofont{Liberation Mono}[Scale=0.9]

\newfontfamily{\vietfont}{Liberation Serif}[Scale=MatchLowercase]

% Unicode math
\usepackage{unicode-math}
\setmathfont{Latin Modern Math}

% Microtype
\usepackage{microtype}
\microtypesetup{protrusion=true, expansion=false, kerning=false, spacing=true}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                    ADDITIONAL PACKAGES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{xcolor}
\definecolor{darkblue}{RGB}{0,0,139}
\usepackage{graphicx}
\graphicspath{{figures/}{chapters/ch2_background/}{chapters/ch3_methodology/}}
\usepackage{calc}
\usepackage{url}
\usepackage{amsmath}
\usepackage{caption}
\usepackage{subcaption}
\captionsetup{justification=centering, labelfont=bf}
\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    stringstyle=\color{red!70!black},
    showstringspaces=false
}

% Định nghĩa ngôn ngữ JSON
\lstdefinelanguage{json}{
    basicstyle=\ttfamily\small,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=1,
    numbersep=5pt,
    showstringspaces=false,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{white},
    literate=
     *{0}{{{\color{numb}0}}}{1}
      {1}{{{\color{numb}1}}}{1}
      {2}{{{\color{numb}2}}}{1}
      {3}{{{\color{numb}3}}}{1}
      {4}{{{\color{numb}4}}}{1}
      {5}{{{\color{numb}5}}}{1}
      {6}{{{\color{numb}6}}}{1}
      {7}{{{\color{numb}7}}}{1}
      {8}{{{\color{numb}8}}}{1}
      {9}{{{\color{numb}9}}}{1}
      {:}{{{\color{punct}{:}}}}{1}
      {,}{{{\color{punct}{,}}}}{1}
      {\{}{{{\color{delim}{\{}}}}{1}
      {\}}{{{\color{delim}{\}}}}}{1}
      {[}{{{\color{delim}{[}}}}{1}
      {]}{{{\color{delim}{]}}}}{1},
}

% Màu sắc JSON
\definecolor{numb}{rgb}{0.63,0.0,0.0}
\definecolor{punct}{rgb}{0.5,0.5,0.5}
\definecolor{delim}{rgb}{0.1,0.1,0.1}
% Bibliography
\usepackage[backend=biber,style=ieee]{biblatex}
\addbibresource{references.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                    CUSTOM MACROS FOR THESIS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\TENLUANVAN}{Hệ thống phát hiện và cảnh báo té ngã thời gian thực tích hợp cảm biến, xử lý ảnh và định vị}
\newcommand{\THESISNAME}{Real-time fall detection and alert system integrating sensors, image processing, and positioning}
\newcommand{\TENTACGIA}{Tran Hao}
\newcommand{\MASOSV}{173401}
\newcommand{\KHOA}{Điện - Điện tử}
\newcommand{\BOMON}{Viễn thông}
\newcommand{\TENNGUOIHUONGDAN}{PSG.TS Ha Hoang Kha}
\newcommand{\NAMBAOVE}{2025}
\newcommand{\DEPARTMENT}{\KHOA}
\newcommand{\TENTACGIAFACULTY}{\TENTACGIA}
\newcommand{\MSSV}{\MASOSV}
\newcommand{\TENCANBO}{\TENNGUOIHUONGDAN}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        PAGE & LAYOUT SETTINGS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{geometry}
\geometry{
    top=2.5cm,
    bottom=2.5cm,
    left=3.0cm,
    right=2.0cm,
    headheight=18pt,
    headsep=12pt,
    footskip=20pt
}

\usepackage{setspace}
\onehalfspacing
\usepackage{indentfirst}
\setlength{\parindent}{1.2em}
\setlength{\parskip}{0pt}
\tolerance=2000
\emergencystretch=0.5em
\hyphenpenalty=5000
\exhyphenpenalty=5000

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                     HEADER, FOOTER & TITLES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{titlesec}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\nouppercase{\leftmark}}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ #1}{}}

% Hyperref (load last)
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=darkblue,
    urlcolor=darkblue,
    citecolor=darkblue,
    pdfauthor={\TENTACGIA},
    pdftitle={\TENLUANVAN}
}
