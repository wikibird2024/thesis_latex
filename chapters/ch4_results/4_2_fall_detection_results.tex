\section{K·∫øt qu·∫£ ki·ªÉm th·ª≠ t·ª´ng th√†nh ph·∫ßn}
\label{sec:component_testing}

Tr∆∞·ªõc khi ti·∫øn h√†nh ph√¢n t√≠ch hi·ªáu nƒÉng, c√°c th·ª≠ nghi·ªám ch·ª©c nƒÉng ƒë∆∞·ª£c th·ª±c hi·ªán ƒë·ªÉ x√°c nh·∫≠n r·∫±ng t·ª´ng th√†nh ph·∫ßn c·ªßa h·ªá th·ªëng ho·∫°t ƒë·ªông ƒë√∫ng nh∆∞ thi·∫øt k·∫ø.  
C√°c log ti√™u bi·ªÉu v√† h√¨nh ·∫£nh minh h·ªça d∆∞·ªõi ƒë√¢y cho th·∫•y qu√° tr√¨nh kh·ªüi t·∫°o, k·∫øt n·ªëi, truy·ªÅn d·ªØ li·ªáu ƒë·ªãnh k·ª≥, ph√°t hi·ªán t√© ng√£, x·ª≠ l√Ω c·∫£nh b√°o v√† truy·ªÅn h√¨nh ·∫£nh.

\subsection{Module c·∫£m bi·∫øn ƒëeo}
Module Quectel EC800K l√† th√†nh ph·∫ßn thu·ªôc module c·∫£m bi·∫øn ƒëeo ƒë∆∞·ª£c ki·ªÉm tra ƒë·ªÉ x√°c nh·∫≠n kh·∫£ nƒÉng giao ti·∫øp AT command, thi·∫øt l·∫≠p k·∫øt n·ªëi 4G v√† thu nh·∫≠n d·ªØ li·ªáu GPS.  

C√°c b∆∞·ªõc ki·ªÉm th·ª≠ bao g·ªìm: kh·ªüi t·∫°o UART, ki·ªÉm tra th√¥ng tin modem v√† SIM, ƒë√°nh gi√° ch·∫•t l∆∞·ª£ng s√≥ng, c·∫•u h√¨nh APN, k√≠ch ho·∫°t PDP context, b·∫≠t GPS v√† truy v·∫•n t·ªça ƒë·ªô, sau ƒë√≥ t·∫Øt GPS v√† ng·∫Øt k·∫øt n·ªëi d·ªØ li·ªáu ƒë·ªÉ ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng.  

K·∫øt qu·∫£ cho th·∫•y m√¥-ƒëun ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh: thi·∫øt b·ªã nh·∫≠n di·ªán ƒë√∫ng (EC800K), SIM s·∫µn s√†ng, t√≠n hi·ªáu m·∫°nh (\texttt{+CSQ: 31,99}), k·∫øt n·ªëi d·ªØ li·ªáu th√†nh c√¥ng v√† thu ƒë∆∞·ª£c t·ªça ƒë·ªô GPS h·ª£p l·ªá.

\textbf{Log ti√™u bi·ªÉu:}
\begin{minted}[fontsize=\footnotesize,breaklines]{text}
I (2329) SIM_4G: Received: Quectel EG800K
OK
I (5329) SIM_4G: Received: +CSQ: 31,99
OK
I (28339) SIM_4G: Received: +QIACT: 1,1,1,"9.204.251.200"
OK
I (34349) SIM_4G: Received: +QGPSLOC: 10.88862,106.77975
OK
\end{minted}

\textit{K·∫øt lu·∫≠n:} M√¥-ƒëun 4G/GPS ƒë√£ ho·∫°t ƒë·ªông ƒë√∫ng ch·ª©c nƒÉng, ƒë·∫£m b·∫£o h·ªá th·ªëng c√≥ th·ªÉ g·ª≠i c·∫£nh b√°o v√† th√¥ng tin ƒë·ªãnh v·ªã qua SMS/MQTT.

\subsection{Kh·ªüi t·∫°o h·ªá th·ªëng v√† k·∫øt n·ªëi m·∫°ng}
Qu√° tr√¨nh kh·ªüi t·∫°o x√°c nh·∫≠n r·∫±ng c√°c m√¥-ƒëun SIM4G-GPS, Wi-Fi v√† c√°c t√°c v·ª• ch√≠nh ƒë·ªÅu ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng, ƒë·∫£m b·∫£o thi·∫øt b·ªã s·∫µn s√†ng tham gia v√†o qu√° tr√¨nh truy·ªÅn th√¥ng v√† gi√°m s√°t.

\begin{minted}[fontsize=\footnotesize,breaklines]{text}
I (9961) SIM4G_AT: Initializing SIM4G AT driver...
I (9981) SIM4G_AT: Successfully set APN to v-internet
I (10011) APP_MAIN: System initialization complete.
I (10021) APP_MAIN: Application started successfully
\end{minted}

\textit{K·∫øt lu·∫≠n:} H·ªá th·ªëng ƒë√£ kh·ªüi t·∫°o th√†nh c√¥ng, ch·ª©ng minh n·ªÅn t·∫£ng ph·∫ßn m·ªÅm v√† ph·∫ßn c·ª©ng ƒë∆∞·ª£c t√≠ch h·ª£p ·ªïn ƒë·ªãnh.

\subsection{K·∫øt n·ªëi MQTT v√† truy·ªÅn d·ªØ li·ªáu}
Thi·∫øt b·ªã ESP32 k·∫øt n·ªëi th√†nh c√¥ng v·ªõi broker MQTT v√† th·ª±c hi·ªán g·ª≠i b·∫£n tin ƒë·ªãnh k·ª≥ ch·ª©a th√¥ng tin ƒë·ªãnh danh, tr·∫°ng th√°i t√© ng√£ v√† d·ªØ li·ªáu GPS.  

\begin{minted}[fontsize=\footnotesize,breaklines]{text}
I (19961) USER_MQTT: MQTT_EVENT_CONNECTED
I (39991) JSON_WRAPPER: Created status payload:
{"device_id":"ESP32_DEV_76E48B","fall_detected":false,
 "latitude":0,"longitude":0,"has_gps_fix":false}
\end{minted}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/json_data_dashboard.png}
    \caption{Dashboard hi·ªÉn th·ªã b·∫£n tin MQTT t·ª´ thi·∫øt b·ªã ESP32.}
    \label{fig:mqtt_dashboard}
\end{figure}

\textit{K·∫øt lu·∫≠n:} K·∫øt n·ªëi MQTT ·ªïn ƒë·ªãnh, ƒë·∫£m b·∫£o thi·∫øt b·ªã c√≥ th·ªÉ truy·ªÅn d·ªØ li·ªáu ƒë·ªãnh k·ª≥ t·ªõi h·ªá th·ªëng gi√°m s√°t trung t√¢m.

\subsection{Ph√°t hi·ªán t√© ng√£ v√† x·ª≠ l√Ω c·∫£nh b√°o}
Thu·∫≠t to√°n ph√°t hi·ªán ghi nh·∫≠n chu·ªói tr·∫°ng th√°i t·ª´ \texttt{LOW\_G} sang \texttt{HIGH\_G}, sau ƒë√≥ x√°c nh·∫≠n va ch·∫°m v√† k√≠ch ho·∫°t c·∫£nh b√°o.  
C·∫£nh b√°o bao g·ªìm g·ª≠i SMS, publish b·∫£n tin MQTT, ƒë·ªìng th·ªùi k√≠ch ho·∫°t buzzer v√† LED c·ª•c b·ªô.  

\begin{minted}[fontsize=\footnotesize,breaklines]{text}
E (159131) FALL_LOGIC: FALL DETECTED! Accel: 0.99 g
I (159151) SIM4G_GPS: SMS request queued successfully
I (159191) SIM4G_GPS: MQTT alert published successfully.
I (159221) buzzer: Beeping for 8000 ms
I (159881) SIM4G_AT: SMS sent successfully.
I (175241) EVENT_HANDLER: Alert sequence completed.
\end{minted}

D∆∞·ªõi ƒë√¢y l√† h√¨nh ·∫£nh \ref{fig:module2_real_log}th·ª±c t·∫ø module c·∫£m bi·∫øn ƒëeo ho·∫°t ƒë·ªông c·∫£nh b√°o v√† log ra monitor
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/module2_real_log.jpg}
    \caption{Dashboard hi·ªÉn th·ªã b·∫£n tin MQTT t·ª´ thi·∫øt b·ªã ESP32.}
    \label{fig:module2_real_log}
\end{figure}

\textit{K·∫øt lu·∫≠n:} H·ªá th·ªëng ph√°t hi·ªán v√† x·ª≠ l√Ω c·∫£nh b√°o t√© ng√£ th√†nh c√¥ng, k√≠ch ho·∫°t ƒë·ªìng th·ªùi nhi·ªÅu k√™nh c·∫£nh b√°o.

\subsection{Module Camera v√† truy·ªÅn h√¨nh ·∫£nh}
M√¥-ƒëun ESP32-CAM ƒë∆∞·ª£c ki·ªÉm tra ƒë·ªÉ x√°c nh·∫≠n kh·∫£ nƒÉng k·∫øt n·ªëi Wi-Fi v√† ph√°t lu·ªìng h√¨nh ·∫£nh qua HTTP.  
K·∫øt qu·∫£ log cho th·∫•y camera ƒë∆∞·ª£c nh·∫≠n di·ªán ƒë√∫ng (OV5640), server HTTP ƒë√£ kh·ªüi ƒë·ªông v√† t·ªëc ƒë·ªô khung h√¨nh trung b√¨nh dao ƒë·ªông trong kho·∫£ng 3.5‚Äì5 FPS.

\begin{minted}[fontsize=\footnotesize,breaklines]{text}
I (8936) esp32cam: Got IP: 10.110.87.85
I (9266) camera: Detected OV5640 camera
I (10006) esp32cam: HTTP server started
I (20006) esp32cam: Frames sent: 50, FPS: 5.87
I (40006) esp32cam: Frames sent: 146, FPS: 4.46
\end{minted}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/module1_stream_example.jpg}
    \caption{Lu·ªìng h√¨nh ·∫£nh ph√°t t·ª´ m√¥-ƒëun ESP32-CAM qua HTTP.}
    \label{fig:camera_stream}
\end{figure}

\textit{K·∫øt lu·∫≠n:} M√¥-ƒëun camera ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh, cho ph√©p gi√°m s√°t h√¨nh ·∫£nh tr·ª±c ti·∫øp ph·ª•c v·ª• x√°c minh s·ª± ki·ªán t√© ng√£.

\subsection{ƒê√°nh gi√° th·ª±c nghi·ªám c·∫£m bi·∫øn v√† d·ªØ li·ªáu thu th·∫≠p}
\subsubsection*{Quy tr√¨nh th·ª≠ nghi·ªám}
ƒê·ªÉ ƒë√°nh gi√° hi·ªáu qu·∫£ ho·∫°t ƒë·ªông c·ªßa h·ªá th·ªëng trong th·ª±c t·∫ø, quy tr√¨nh th·ª≠ nghi·ªám ƒë∆∞·ª£c ti·∫øn h√†nh theo c√°c b∆∞·ªõc:
\begin{enumerate}
    \item N·∫°p ch∆∞∆°ng tr√¨nh v√†o ESP32 b·∫±ng \texttt{idf.py flash monitor}.  
    \item Gi·∫£ l·∫≠p t√¨nh hu·ªëng t√© ng√£ b·∫±ng c√°ch l·∫Øc m·∫°nh ho·∫∑c th·∫£ nh·∫π thi·∫øt b·ªã.  
    \item Quan s√°t log h·ªá th·ªëng ƒë·ªÉ x√°c nh·∫≠n s·ª± ki·ªán.  
    \item Ki·ªÉm tra t√≠nh nƒÉng g·ª≠i c·∫£nh b√°o SMS v·ªõi d·ªØ li·ªáu GPS.  
    \item L·∫∑p l·∫°i nhi·ªÅu l·∫ßn ƒë·ªÉ ƒë√°nh gi√° t√≠nh ·ªïn ƒë·ªãnh v√† ƒë·ªô nh·∫°y.
\end{enumerate}

\subsubsection*{Ph√¢n t√≠ch d·ªØ li·ªáu c·∫£m bi·∫øn}
Trong qu√° tr√¨nh th·ª≠ nghi·ªám, d·ªØ li·ªáu MPU6050 ƒë∆∞·ª£c thu th·∫≠p cho hai tr·∫°ng th√°i: \textbf{t√© ng√£} v√† \textbf{b√¨nh th∆∞·ªùng}.  
C√°c b·∫£ng d∆∞·ªõi ƒë√¢y tr√¨nh b√†y to√†n b·ªô d·ªØ li·ªáu ƒë√£ ghi nh·∫≠n.

\begin{table}[h]
\centering
\caption{D·ªØ li·ªáu trong t√¨nh hu·ªëng t√© ng√£}
\label{tab:fall_data}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\textbf{Gyro X} & \textbf{Gyro Y} & \textbf{Gyro Z} & \textbf{Gyro Mag} & \textbf{Accel X} & \textbf{Accel Y} & \textbf{Accel Z} & \textbf{Accel Mag} \\
\hline
129.60 & -36.77 & 29.19 & 137.84 & 0.65 & 0.79 & -0.79 & 1.29 \\
-43.90 & 214.79 & 52.97 & 225.54 & 0.53 & 2.00 & -2.00 & 2.88 \\
158.75 & 250.13 & 134.18 & 325.22 & -1.18 & 1.72 & 1.56 & 2.61 \\
-250.14 & -246.07 & -250.14 & 430.91 & 1.11 & 2.00 & -2.00 & 3.04 \\
242.56 & 250.13 & 250.13 & 428.91 & -1.33 & -2.00 & 2.00 & 3.13 \\
-11.60 & -146.43 & -169.58 & 224.35 & 1.80 & 2.00 & -2.00 & 3.35 \\
201.32 & 238.97 & 250.13 & 400.25 & -2.00 & 0.21 & 2.00 & 2.84 \\
-250.14 & -250.14 & -250.14 & 433.25 & 0.55 & 0.23 & -0.37 & 0.69 \\
\hline
\end{tabular}
\end{table}

\begin{table}[h]
\centering
\caption{D·ªØ li·ªáu trong t√¨nh hu·ªëng b√¨nh th∆∞·ªùng}
\label{tab:normal_data}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\textbf{Gyro X} & \textbf{Gyro Y} & \textbf{Gyro Z} & \textbf{Gyro Mag} & \textbf{Accel X} & \textbf{Accel Y} & \textbf{Accel Z} & \textbf{Accel Mag} \\
\hline
1.27 & -1.46 & 0.51 & 2.00 & -0.03 & 0.01 & -0.96 & 0.96 \\
1.07 & -0.95 & 0.53 & 1.52 & -0.04 & 0.02 & -0.97 & 0.97 \\
1.18 & -1.36 & 0.73 & 1.94 & -0.03 & 0.02 & -0.97 & 0.97 \\
1.03 & -1.02 & 0.40 & 1.50 & -0.03 & 0.01 & -0.97 & 0.97 \\
1.37 & -1.08 & 0.58 & 1.84 & -0.03 & 0.01 & -0.97 & 0.97 \\
0.77 & -0.83 & 0.47 & 1.23 & -0.03 & 0.01 & -0.97 & 0.97 \\
1.02 & -0.37 & 0.77 & 1.33 & -0.03 & 0.01 & -0.97 & 0.97 \\
\hline
\end{tabular}
\end{table}

Ngo√†i ra, d·ªØ li·ªáu GPS thu ƒë∆∞·ª£c t·ª´ m√¥-ƒëun 4G/GPS trong c√°c l·∫ßn th·ª≠ nghi·ªám ngo√†i tr·ªùi c≈©ng ƒë∆∞·ª£c ghi l·∫°i:

\begin{table}[h]
\centering
\caption{D·ªØ li·ªáu GPS thu ƒë∆∞·ª£c t·ª´ m√¥-ƒëun 4G/GPS}
\label{tab:gps_data}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
\textbf{Time (UTC)} & \textbf{Latitude} & \textbf{Longitude} & \textbf{Altitude (m)} & \textbf{Fix Mode} & \textbf{Date} & \textbf{Satellites} \\
\hline
132517.00 & 1053.3115N & 10646.7839E & 5.07 & 3 & 240425 & 07 \\
132517.00 & 1053.3115N & 10646.7839E & 5.07 & 3 & 240425 & 07 \\
132540.00 & 1053.3117N & 10646.7840E & 5.05 & 3 & 240425 & 07 \\
132540.00 & 1053.3117N & 10646.7840E & 5.05 & 3 & 240425 & 07 \\
132627.00 & 1053.3107N & 10646.7839E & 5.02 & 3 & 240425 & 07 \\
132627.00 & 1053.3107N & 10646.7839E & 5.02 & 3 & 240425 & 07 \\
\hline
\end{tabular}
\end{table}

\subsubsection*{So s√°nh d·ªØ li·ªáu}
ƒê·ªÉ ƒë√°nh gi√° s·ª± kh√°c bi·ªát r√µ r·ªát gi·ªØa hai tr·∫°ng th√°i, d·ªØ li·ªáu ƒë∆∞·ª£c t·ªïng h·ª£p th√†nh c√°c gi√° tr·ªã trung b√¨nh:

\begin{table}[h]
\centering
\caption{So s√°nh d·ªØ li·ªáu t√© ng√£ v√† b√¨nh th∆∞·ªùng}
\label{tab:comparison}
\begin{tabular}{|l|c|c|}
\hline
\textbf{Th√¥ng s·ªë} & \textbf{Trung b√¨nh t√© ng√£} & \textbf{Trung b√¨nh b√¨nh th∆∞·ªùng} \\
\hline
Gyro X (deg/s) & 22.06 & 1.10 \\
Gyro Y (deg/s) & 34.33 & -1.03 \\
Gyro Z (deg/s) & 5.84  & 0.57 \\
Gyro Mag (deg/s) & 325.78 & 1.63 \\
Accel X (g)   & 0.02  & -0.03 \\
Accel Y (g)   & 0.87  & 0.01 \\
Accel Z (g)   & -0.20 & -0.97 \\
Accel Mag (g) & 2.48  & 0.97 \\
\hline
\end{tabular}
\end{table}

\textit{K·∫øt lu·∫≠n:} D·ªØ li·ªáu c·∫£m bi·∫øn cho th·∫•y s·ª± kh√°c bi·ªát r√µ r·ªát gi·ªØa hai tr·∫°ng th√°i. ƒê·∫∑c bi·ªát, \textbf{Accel Mag} v√† \textbf{Gyro Mag} l√† ch·ªâ b√°o hi·ªáu qu·∫£ ƒë·ªÉ ph√°t hi·ªán t√© ng√£, cung c·∫•p c∆° s·ªü th·ª±c nghi·ªám cho vi·ªác tinh ch·ªânh ng∆∞·ª°ng ph√°t hi·ªán v√† gi·∫£m thi·ªÉu c·∫£nh b√°o sai.

\subsection{M√¥-ƒëun nh·∫≠n di·ªán h√¨nh ·∫£nh (Python)}
\label{sec:python_vision}

M√¥-ƒëun nh·∫≠n di·ªán h√¨nh ·∫£nh ƒë∆∞·ª£c x√¢y d·ª±ng b·∫±ng Python nh·∫±m th·ª±c hi·ªán c√°c ch·ª©c nƒÉng: thu nh·∫≠n lu·ªìng d·ªØ li·ªáu t·ª´ camera, tri·ªÉn khai m√¥ h√¨nh h·ªçc s√¢u ƒë·ªÉ d·ª±ng khung x∆∞∆°ng (skeleton), ƒë·ªìng th·ªùi t√≠ch h·ª£p v·ªõi h·ªá th·ªëng g·ª≠i c·∫£nh b√°o qua MQTT v√† Telegram. Ngo√†i ra, m√¥-ƒëun c√≤n ghi log v√†o c∆° s·ªü d·ªØ li·ªáu SQLite v√† duy tr√¨ k·∫øt n·ªëi v·ªõi Asterisk Management Interface (AMI).  

Trong qu√° tr√¨nh th·ª≠ nghi·ªám, h·ªá th·ªëng ƒë∆∞·ª£c kh·ªüi ƒë·ªông tr·ª±c ti·∫øp t·ª´ m√¥i tr∆∞·ªùng ·∫£o Python. C√°c ti·∫øn tr√¨nh ch√≠nh ƒë∆∞·ª£c kh·ªüi t·∫°o bao g·ªìm: \texttt{mqtt\_listener}, \texttt{mqtt\_processor}, \texttt{camera\_processing} v√† \texttt{heartbeat}. Log ti√™u bi·ªÉu minh h·ªça k·∫øt qu·∫£ th·ª≠ nghi·ªám ƒë∆∞·ª£c tr√¨nh b√†y d∆∞·ªõi ƒë√¢y.

D∆∞·ªõi ƒë√¢y l√† h√¨nh ·∫£nh \ref{fig:python_runing_log}th·ª±c t·∫ø Python x·ª≠ l√Ω ·∫£nh v√† ƒëi·ªÅu ph·ªëi c√°c t√°c v·ª• log ra monitor
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/python_runing_log.png}
    \caption{Dashboard hi·ªÉn th·ªã b·∫£n tin MQTT t·ª´ thi·∫øt b·ªã ESP32.}
    \label{fig:python_runing_log}
\end{figure}

\subsubsection*{Log th·ª±c nghi·ªám}
\begin{minted}[fontsize=\footnotesize,breaklines]{text}
[SYSTEM] üöÄ Starting Fall Detection System...
[SYSTEM] Initializing modules...
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
[TELEGRAM] Bot initialized.
[DB] Database and table created successfully.
[MQTT] üîÑ Starting MQTT client for io.adafruit.com:1883, topic=tranhao/feeds/json_data
[MQTT] ‚úÖ MQTT client connected.
[AMI] ‚úÖ Connected to AMI server.
[CAMERA] Starting camera processing task...
[SYSTEM] ‚úÖ Starting 4 concurrent tasks...
[CAMERA] ‚úÖ Successfully opened camera: 0
/home/hx/.pyenv/versions/.intergrate_venv/lib/python3.10/site-packages/torch/cuda/__init__.py:138:
UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 9010)...
\end{minted}

\subsubsection*{Ph√¢n t√≠ch k·∫øt qu·∫£}
T·ª´ log tr√™n c√≥ th·ªÉ r√∫t ra c√°c nh·∫≠n x√©t sau:
\begin{itemize}
    \item \textbf{Kh·ªüi t·∫°o h·ªá th·ªëng:} C√°c m√¥-ƒëun c·ªët l√µi (MQTT, c∆° s·ªü d·ªØ li·ªáu, Telegram bot, AMI) ƒë·ªÅu ƒë∆∞·ª£c kh·ªüi t·∫°o th√†nh c√¥ng. ƒêi·ªÅu n√†y ch·ª©ng minh kh·∫£ nƒÉng t√≠ch h·ª£p c·ªßa h·ªá th·ªëng Python v·ªõi h·∫° t·∫ßng d·ªãch v·ª• b√™n ngo√†i.
    \item \textbf{X·ª≠ l√Ω camera:} Camera n·ªôi b·ªô ƒë∆∞·ª£c m·ªü th√†nh c√¥ng (\texttt{Successfully opened camera: 0}), kh·∫≥ng ƒë·ªãnh r·∫±ng m√¥-ƒëun x·ª≠ l√Ω h√¨nh ·∫£nh ƒë√£ s·∫µn s√†ng cho t√°c v·ª• nh·∫≠n di·ªán skeleton.
    \item \textbf{M√¥ h√¨nh h·ªçc m√°y:} TensorFlow Lite XNNPACK delegate cho CPU ƒë∆∞·ª£c kh·ªüi ƒë·ªông th√†nh c√¥ng. C·∫£nh b√°o t·ª´ th∆∞ vi·ªán CUDA cho th·∫•y driver GPU kh√¥ng t∆∞∆°ng th√≠ch, tuy nhi√™n h·ªá th·ªëng v·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng tr√™n n·ªÅn t·∫£ng CPU.
    \item \textbf{ƒêa nhi·ªám ƒë·ªìng th·ªùi:} B·ªën t√°c v·ª• ch√≠nh (\texttt{mqtt\_listener}, \texttt{mqtt\_processor}, \texttt{camera\_processing}, \texttt{heartbeat}) ƒë∆∞·ª£c kh·ªüi ch·∫°y song song, th·ªÉ hi·ªán t√≠nh ·ªïn ƒë·ªãnh c·ªßa pipeline x·ª≠ l√Ω.
\end{itemize}

\subsubsection*{} 
K·∫øt qu·∫£ th·ª≠ nghi·ªám ch·ª©ng minh r·∫±ng m√¥-ƒëun Python ƒë√£ ho·∫°t ƒë·ªông ƒë√∫ng ch·ª©c nƒÉng, b·∫£o ƒë·∫£m kh·∫£ nƒÉng thu nh·∫≠n d·ªØ li·ªáu camera, ch·∫°y nh·∫≠n di·ªán h√¨nh ·∫£nh, ƒë·ªìng b·ªô d·ªØ li·ªáu qua MQTT, v√† k√≠ch ho·∫°t c√°c k√™nh c·∫£nh b√°o. H·ªá th·ªëng tuy c√≥ h·∫°n ch·∫ø v·ªÅ h·ªó tr·ª£ CUDA (do phi√™n b·∫£n driver c≈©) nh∆∞ng kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn qu√° tr√¨nh th·ª±c thi tr√™n CPU. ƒê√¢y l√† minh ch·ª©ng cho t√≠nh ·ªïn ƒë·ªãnh v√† kh·∫£ nƒÉng tri·ªÉn khai c·ªßa gi·∫£i ph√°p trong ƒëi·ªÅu ki·ªán ph·∫ßn c·ª©ng ph·ªï th√¥ng.

\subsection{K√™nh c·∫£nh b√°o Telegram}
\label{sec:telegram_alert}

H·ªá th·ªëng Telegram Bot ƒë√≥ng vai tr√≤ l√† k√™nh c·∫£nh b√°o tr·ª±c quan, gi√∫p g·ª≠i th√¥ng b√°o ƒë·∫øn ng∆∞·ªùi d√πng ngay khi ph√°t hi·ªán t√© ng√£.  
C∆° ch·∫ø ho·∫°t ƒë·ªông ƒë∆∞·ª£c chia th√†nh hai h∆∞·ªõng:
\begin{itemize}
    \item \textbf{T·ª´ m√¥-ƒëun ph·∫ßn c·ª©ng (ESP32 + 4G/GPS):} Khi x·∫£y ra s·ª± ki·ªán t√© ng√£, b·∫£n tin MQTT ho·∫∑c SMS ƒë∆∞·ª£c ph√°t ra t·ª´ thi·∫øt b·ªã. H·ªá th·ªëng trung t√¢m sau ƒë√≥ chuy·ªÉn ti·∫øp n·ªôi dung n√†y ƒë·∫øn ng∆∞·ªùi d√πng th√¥ng qua Telegram.
    \item \textbf{T·ª´ m√¥-ƒëun x·ª≠ l√Ω h√¨nh ·∫£nh (Python):} Khi nh·∫≠n di·ªán ƒë∆∞·ª£c t√© ng√£ qua camera v√† skeleton, h·ªá th·ªëng Python tr·ª±c ti·∫øp g·ª≠i c·∫£nh b√°o ƒë·∫øn Telegram, k√®m th√¥ng tin chi ti·∫øt.
\end{itemize}

\subsubsection*{Log minh h·ªça}
\begin{minted}[fontsize=\footnotesize,breaklines]{text}
[TELEGRAM] Bot initialized.
2025-09-12 12:55:17,594 - INFO - HTTP Request: POST
https://api.telegram.org/botXXXX/sendMessage "HTTP/1.1 200 OK"
[TELEGRAM] Test message sent successfully.
I (159151) SIM4G_GPS: SMS request queued successfully
I (159191) SIM4G_GPS: MQTT alert published successfully.
I (159881) SIM4G_AT: SMS sent successfully.
\end{minted}

\subsubsection*{K·∫øt qu·∫£ th·ª≠ nghi·ªám}
Trong qu√° tr√¨nh ch·∫°y th·ª≠, Telegram Bot ƒë√£ nh·∫≠n th√†nh c√¥ng c·∫£nh b√°o t·ª´ c·∫£ hai ngu·ªìn:
\begin{itemize}
    \item \textbf{M√¥-ƒëun ph·∫ßn c·ª©ng:} g·ª≠i c·∫£nh b√°o khi h·ªá th·ªëng ESP32 ph√°t hi·ªán t√© ng√£ v√† k√≠ch ho·∫°t chu·ªói x·ª≠ l√Ω SMS/MQTT.
    \item \textbf{M√¥-ƒëun Python:} g·ª≠i c·∫£nh b√°o tr·ª±c ti·∫øp khi nh·∫≠n di·ªán t√© ng√£ qua camera v√† skeleton tracking.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/telegram_fall_module1_send.png}
    \caption{Th√¥ng b√°o c·∫£nh b√°o t√© ng√£ t·ª´ m√¥-ƒëun ph·∫ßn c·ª©ng (ESP32) qua Telegram.}
    \label{fig:telegram_hw}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/telegram_python_fall_send.png}
    \caption{Th√¥ng b√°o c·∫£nh b√°o t√© ng√£ t·ª´ m√¥-ƒëun x·ª≠ l√Ω h√¨nh ·∫£nh Python qua Telegram.}
    \label{fig:telegram_python}
\end{figure}

\subsubsection*{Nh·∫≠n x√©t}
K·∫øt qu·∫£ ch·ª©ng minh r·∫±ng Telegram Bot ƒë√£ ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh, ƒë√≥ng vai tr√≤ l√† c·∫ßu n·ªëi quan tr·ªçng gi·ªØa h·ªá th·ªëng ph√°t hi·ªán t√© ng√£ v√† ng∆∞·ªùi d√πng cu·ªëi.  
Vi·ªác k·∫øt h·ª£p c·∫£ hai ngu·ªìn c·∫£nh b√°o (thi·∫øt b·ªã ph·∫ßn c·ª©ng v√† m√¥-ƒëun x·ª≠ l√Ω h√¨nh ·∫£nh) gi√∫p tƒÉng ƒë·ªô tin c·∫≠y v√† gi·∫£m thi·ªÉu kh·∫£ nƒÉng b·ªè s√≥t s·ª± ki·ªán.
\paragraph{}  
C√°c th·ª≠ nghi·ªám ch·ª©c nƒÉng tr√™n kh·∫≥ng ƒë·ªãnh r·∫±ng t·ª´ng th√†nh ph·∫ßn c·ªßa h·ªá th·ªëng ƒë√£ ho·∫°t ƒë·ªông ƒë√∫ng theo h∆∞·ªõng mong mu·ªën.
